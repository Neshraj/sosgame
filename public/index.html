<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS</title>
    <link rel="stylesheet" href="style.css">

</head>
<body>



    <div id="home">
        <input type="text" name="roomname" id="roomname" placeholder="Room Name">
        <div id="homebottom">
            <button class="jcbtn" id="createroom" onclick="createrroom()">Create Room</button>
            <button class="jcbtn" id="joinroom" onclick="joinroom()">Join room</button>
        </div>
    </div>

    <div id="insidegame">

        <header id="head">
            <span id="pl1n">Player 1 ponts : <span id="pl1p">0</span></span>
            <span id="headt">SOS</span>
            <span id="pl2n">Player 1 ponts : <span id="pl2p">0</span></span>
            <span id="playermove">Next Move</span>
        </header>

    

    <div id="main">

        <button class="box" onclick="msg(1)" id="1">.</button>
        <button class="box" onclick="msg(2)" id="2">.</button>
        <button class="box" onclick="msg(3)" id="3">.</button>
        <button class="box" onclick="msg(4)" id="4">.</button>
        <button class="box" onclick="msg(5)" id="5">.</button>
        <button class="box" onclick="msg(6)" id="6">.</button>
        <button class="box" onclick="msg(7)" id="7">.</button>
        <button class="box" onclick="msg(8)" id="8">.</button>
        <button class="box" onclick="msg(9)" id="9">.</button>
        <button class="box" onclick="msg(10)" id="10">.</button>
        <button class="box" onclick="msg(11)" id="11">.</button>
        <button class="box" onclick="msg(12)" id="12">.</button>
        <button class="box" onclick="msg(13)" id="13">.</button>
        <button class="box" onclick="msg(14)" id="14">.</button>
        <button class="box" onclick="msg(15)" id="15">.</button>
        <button class="box" onclick="msg(16)" id="16">.</button>
        <button class="box" onclick="msg(17)" id="17">.</button>
        <button class="box" onclick="msg(18)" id="18">.</button>
        <button class="box" onclick="msg(19)" id="19">.</button>
        <button class="box" onclick="msg(20)" id="20">.</button>
        <button class="box" onclick="msg(21)" id="21">.</button>
        <button class="box" onclick="msg(22)" id="22">.</button>
        <button class="box" onclick="msg(23)" id="23">.</button>
        <button class="box" onclick="msg(24)" id="24">.</button>
        <button class="box" onclick="msg(25)" id="25">.</button>
        <button class="box" onclick="msg(26)" id="26">.</button>
        <button class="box" onclick="msg(27)" id="27">.</button>
        <button class="box" onclick="msg(28)" id="28">.</button>
        <button class="box" onclick="msg(29)" id="29">.</button>
        <button class="box" onclick="msg(30)" id="30">.</button>
        <button class="box" onclick="msg(31)" id="31">.</button>
        <button class="box" onclick="msg(32)" id="32">.</button>
        <button class="box" onclick="msg(33)" id="33">.</button>
        <button class="box" onclick="msg(34)" id="34">.</button>
        <button class="box" onclick="msg(35)" id="35">.</button>
        <button class="box" onclick="msg(36)" id="36">.</button>
        <button class="box" onclick="msg(37)" id="37">.</button>
        <button class="box" onclick="msg(38)" id="38">.</button>
        <button class="box" onclick="msg(39)" id="39">.</button>
        <button class="box" onclick="msg(40)" id="40">.</button>
        <button class="box" onclick="msg(41)" id="41">.</button>
        <button class="box" onclick="msg(42)" id="42">.</button>
        <button class="box" onclick="msg(43)" id="43">.</button>
        <button class="box" onclick="msg(44)" id="44">.</button>
        <button class="box" onclick="msg(45)" id="45">.</button>
        <button class="box" onclick="msg(46)" id="46">.</button>
        <button class="box" onclick="msg(47)" id="47">.</button>
        <button class="box" onclick="msg(48)" id="48">.</button>
        <button class="box" onclick="msg(49)" id="49">.</button>
        <button class="box" onclick="msg(50)" id="50">.</button>
        <button class="box" onclick="msg(51)" id="51">.</button>
        <button class="box" onclick="msg(52)" id="52">.</button>
        <button class="box" onclick="msg(53)" id="53">.</button>
        <button class="box" onclick="msg(54)" id="54">.</button>
        <button class="box" onclick="msg(55)" id="55">.</button>
        <button class="box" onclick="msg(56)" id="56">.</button>
        <button class="box" onclick="msg(57)" id="57">.</button>
        <button class="box" onclick="msg(58)" id="58">.</button>
        <button class="box" onclick="msg(59)" id="59">.</button>
        <button class="box" onclick="msg(60)" id="60">.</button>
        <button class="box" onclick="msg(61)" id="61">.</button>
        <button class="box" onclick="msg(62)" id="62">.</button>
        <button class="box" onclick="msg(63)" id="63">.</button>
        <button class="box" onclick="msg(64)" id="64">.</button>
        <button class="box" onclick="msg(65)" id="65">.</button>
        <button class="box" onclick="msg(66)" id="66">.</button>
        <button class="box" onclick="msg(67)" id="67">.</button>
        <button class="box" onclick="msg(68)" id="68">.</button>
        <button class="box" onclick="msg(69)" id="69">.</button>
        <button class="box" onclick="msg(70)" id="70">.</button>
        <button class="box" onclick="msg(71)" id="71">.</button>
        <button class="box" onclick="msg(72)" id="72">.</button>
        <button class="box" onclick="msg(73)" id="73">.</button>
        <button class="box" onclick="msg(74)" id="74">.</button>
        <button class="box" onclick="msg(75)" id="75">.</button>
        <button class="box" onclick="msg(76)" id="76">.</button>
        <button class="box" onclick="msg(77)" id="77">.</button>
        <button class="box" onclick="msg(78)" id="78">.</button>
        <button class="box" onclick="msg(79)" id="79">.</button>
        <button class="box" onclick="msg(80)" id="80">.</button>
        <button class="box" onclick="msg(81)" id="81">.</button>
        <button class="box" onclick="msg(82)" id="82">.</button>
        <button class="box" onclick="msg(83)" id="83">.</button>
        <button class="box" onclick="msg(84)" id="84">.</button>
        <button class="box" onclick="msg(85)" id="85">.</button>
        <button class="box" onclick="msg(86)" id="86">.</button>
        <button class="box" onclick="msg(87)" id="87">.</button>
        <button class="box" onclick="msg(88)" id="88">.</button>
        <button class="box" onclick="msg(89)" id="89">.</button>
        <button class="box" onclick="msg(90)" id="90">.</button>
        <button class="box" onclick="msg(91)" id="91">.</button>
        <button class="box" onclick="msg(92)" id="92">.</button>
        <button class="box" onclick="msg(93)" id="93">.</button>
        <button class="box" onclick="msg(94)" id="94">.</button>
        <button class="box" onclick="msg(95)" id="95">.</button>
        <button class="box" onclick="msg(96)" id="96">.</button>
        <button class="box" onclick="msg(97)" id="97">.</button>
        <button class="box" onclick="msg(98)" id="98">.</button>
        <button class="box" onclick="msg(99)" id="99">.</button>
        <button class="box" onclick="msg(100)" id="100">.</button>


        

        

    </div>

    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>

    <script>

    const socket = io();
    let currentRoom = '';


    function createrroom(){
        if(document.getElementById('roomname').value.trim().length==0){
            alert("Pleas enter the room Room name");
        }

        else{
            const roomName = document.getElementById('roomname').value.trim();

            socket.emit('createRoom',{roomName});
            currentRoom = roomName;

            document.getElementById('home').style.display='none';
            document.getElementById('insidegame').style.display='block';
            msg(0);
        }
    }


    function joinroom(){
        if(document.getElementById('roomname').value.trim().length==0){
            alert("Pleas enter the room Room name");
        }

        else{
            const roomName = document.getElementById('roomname').value.trim();

            socket.emit('joinRoom', { roomName });
            currentRoom = roomName;

            document.getElementById('home').style.display='none';
            document.getElementById('insidegame').style.display='block';
            msg(0);
        }
    }



    socket.on('roomExists',() => {
      alert('Room already exists. Please choose a different room name.');
      location.reload();
    });



    socket.on('userJoined', (data) => {
    const userjoined = new Audio('./assets/recieveaudio.mp3');
    userjoined.play();
    alert('player Jioned');
  });


  socket.on('roomFull', () => {
      alert('Room is full. Cannot join the room.');
      location.reload();
    });


    socket.on('invalidRoom', () => {
    alert('Invalid room Please try again.');
    location.reload();
  });







let player = 1;
//let ind = 0;
let mplayer = 1;
pp1=0;
pp2=0;
mpp1=0;
mpp2=0;
function msg(ind){
    //let mind=indp;


    socket.emit('sendMessage', { roomName: currentRoom, ind, player:mplayer, pp1:mpp1, pp2:mpp2});


    socket.on('receiveMessage', (data) =>{

        let {ind ,player, pp1, pp2} = data;
        pp1=pp1;
        document.getElementById('pl1p').innerText=pp1;
        pp2=pp2;
        document.getElementById('pl2p').innerText=pp1;
        if(player==1){
        document.getElementById(ind).innerText="S";



        document.getElementById('playermove').style.backgroundColor="rgb(198, 255, 181)";
        mplayer = 2;
        document.getElementById(ind).style.borderColor="rgb(255, 129, 129)";
        document.getElementById(ind).disabled=true;
        //alert(ind+1);
        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind-1).innerText=='O' && document.getElementById(ind-2).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-1).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-2).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            

        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind+1).innerText=='O' && document.getElementById(ind+2).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+1).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+2).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind-20).innerText=='S' && document.getElementById(ind-10).innerText=='O'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-20).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-10).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind+20).innerText=='S' && document.getElementById(ind+10).innerText=='O'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+20).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+10).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind-11).innerText=='O' && document.getElementById(ind-22).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-11).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-22).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind-9).innerText=='O' && document.getElementById(ind-18).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-9).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind-18).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }


        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind+9).innerText=='O' && document.getElementById(ind+18).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+9).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+18).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }

        if(document.getElementById(ind).innerText=='S' && document.getElementById(ind+11).innerText=='O' && document.getElementById(ind+22).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+11).style.backgroundColor="rgb(255, 181, 181)";
            document.getElementById(ind+22).style.backgroundColor="rgb(255, 181, 181)";
            pp1=pp1+1;
            mpp1=mpp1+1;
            document.getElementById('pl1p').innerText=pp1;
            
        }


    }
    else{
        document.getElementById(ind).innerText="O";
        document.getElementById('playermove').style.backgroundColor="rgb(255, 181, 181)";
        mplayer = 1;
        document.getElementById(ind).style.borderColor="rgb(48, 140, 20)";
        document.getElementById(ind).disabled=true;

        if(document.getElementById(ind-1).innerText=='S' && document.getElementById(ind+1).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind-1).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind+1).style.backgroundColor="rgb(198, 255, 181)";
            pp2=pp2+1;
            mpp2=mpp2+1;
            mpp2=mpp2+1;
            document.getElementById('pl2p').innerText=pp2;
            

        }


        if(document.getElementById(ind-10).innerText=='S' && document.getElementById(ind+10).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind-10).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind+10).style.backgroundColor="rgb(198, 255, 181)";
            pp2=pp2+1;
            mpp2=mpp2+1;
            document.getElementById('pl2p').innerText=pp2;
            
        }


        if(document.getElementById(ind-11).innerText=='S' && document.getElementById(ind+11).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind-11).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind+11).style.backgroundColor="rgb(198, 255, 181)";
            pp2=pp2+1;
            mpp2=mpp2+1;
            document.getElementById('pl2p').innerText=pp2;
            
        }

        if(document.getElementById(ind-9).innerText=='S' && document.getElementById(ind+9).innerText=='S'){
            document.getElementById(ind).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind-9).style.backgroundColor="rgb(198, 255, 181)";
            document.getElementById(ind+9).style.backgroundColor="rgb(198, 255, 181)";
            pp2=pp2+1;
            mpp2=mpp2+1;
            document.getElementById('pl2p').innerText=pp2;
            
        }


        
    }












    });


































    //let allbox = document.querySelectorAll(".box");
    //alert('cliked'+ind+' '+player);
    
}



    </script>
    


</body>
</html>